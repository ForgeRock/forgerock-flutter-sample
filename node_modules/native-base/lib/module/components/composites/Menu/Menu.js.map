{"version":3,"sources":["Menu.tsx"],"names":["React","memo","forwardRef","Box","usePropsResolution","Popper","AccessibilityInfo","ScrollView","useControllableState","useMenuTrigger","useMenu","useMenuTypeahead","Backdrop","PresenceTransition","FocusScope","MenuContext","Overlay","useHasResponsiveProps","Menu","trigger","closeOnSelect","children","onOpen","onClose","isOpen","isOpenProp","defaultIsOpen","placement","props","ref","triggerRef","useRef","setIsOpen","value","defaultValue","onChange","transition","resolvedProps","handleOpen","useCallback","handleClose","triggerProps","updatedTrigger","onPress","open","useEffect","announceForAccessibility","MenuContent","menuRef","menuProps","typeaheadProps"],"mappings":"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","sourcesContent":["import React, { memo, forwardRef } from 'react';\nimport type { IMenuProps } from './types';\nimport Box from '../../primitives/Box';\nimport { usePropsResolution } from '../../../hooks/useThemeProps';\nimport { Popper } from '../Popper';\nimport { AccessibilityInfo, ScrollView } from 'react-native';\nimport { useControllableState } from '../../../hooks';\nimport { useMenuTrigger, useMenu, useMenuTypeahead } from './useMenu';\nimport Backdrop from '../Backdrop';\nimport { PresenceTransition } from '../Transitions';\nimport { FocusScope } from '@react-native-aria/focus';\nimport { MenuContext } from './MenuContext';\nimport { Overlay } from '../../primitives/Overlay';\nimport { useHasResponsiveProps } from '../../../hooks/useHasResponsiveProps';\n\nconst Menu = (\n  {\n    trigger,\n    closeOnSelect = true,\n    children,\n    onOpen,\n    onClose,\n    isOpen: isOpenProp,\n    defaultIsOpen,\n    placement = 'bottom left',\n    ...props\n  }: IMenuProps,\n  ref?: any\n) => {\n  const triggerRef = React.useRef(null);\n  const [isOpen, setIsOpen] = useControllableState({\n    value: isOpenProp,\n    defaultValue: defaultIsOpen,\n    onChange: (value) => {\n      value ? onOpen && onOpen() : onClose && onClose();\n    },\n  });\n\n  const { transition, ...resolvedProps } = usePropsResolution('Menu', props);\n  const handleOpen = React.useCallback(() => {\n    setIsOpen(true);\n  }, [setIsOpen]);\n\n  const handleClose = React.useCallback(() => {\n    setIsOpen(false);\n  }, [setIsOpen]);\n\n  const triggerProps = useMenuTrigger({\n    handleOpen,\n    isOpen,\n  });\n\n  const updatedTrigger = () => {\n    return trigger(\n      {\n        ...triggerProps,\n        ref: triggerRef,\n        onPress: handleOpen,\n      },\n      { open: isOpen }\n    );\n  };\n\n  React.useEffect(() => {\n    if (isOpen) {\n      AccessibilityInfo.announceForAccessibility('Popup window');\n    }\n  }, [isOpen]);\n\n  //TODO: refactor for responsive prop\n  if (useHasResponsiveProps(resolvedProps)) {\n    return null;\n  }\n  return (\n    <>\n      {updatedTrigger()}\n      <Overlay isOpen={isOpen} onRequestClose={handleClose} useRNModalOnAndroid>\n        <PresenceTransition visible={isOpen} {...transition}>\n          <Popper\n            triggerRef={triggerRef}\n            onClose={handleClose}\n            placement={placement}\n            {...props}\n          >\n            <Backdrop bg=\"transparent\" onPress={handleClose} />\n            <Popper.Content>\n              <MenuContext.Provider\n                value={{ closeOnSelect, onClose: handleClose }}\n              >\n                <FocusScope contain restoreFocus autoFocus>\n                  <MenuContent menuRef={ref} {...resolvedProps}>\n                    {children}\n                  </MenuContent>\n                </FocusScope>\n              </MenuContext.Provider>\n            </Popper.Content>\n          </Popper>\n        </PresenceTransition>\n      </Overlay>\n    </>\n  );\n};\n\nconst MenuContent = ({\n  menuRef,\n  children,\n  ...props\n}: Omit<IMenuProps, 'trigger'> & { menuRef: any }) => {\n  const menuProps = useMenu();\n  const typeaheadProps = useMenuTypeahead(menuProps);\n\n  return (\n    <Box {...props} {...menuProps} {...typeaheadProps} ref={menuRef}>\n      <ScrollView>{children}</ScrollView>\n    </Box>\n  );\n};\n\nexport default memo(forwardRef(Menu));\n"]}